rm(list=ls())
library(ISLR)
library(MASS)
library(tidyverse)
library(Rfast)
library(chisq.posthoc.test)
library(RVAideMemoire)
props <- seq(.5,.85,.02)
coop1 <- .93
coop2 <- .84
#coop3 <- .7
n1 <- 40
n2 <- 20
n3 <- 20
z <- c()
for(i in 1:length(props)){
a1 <- rep("Cooperate", round(n1*coop1, 0))
a2 <- rep("Defect",  round(n1-(n1*coop1), 0))
cond <- rep("Sync", n1)
sync_vec <- cbind(c(a1,a2), cond)
a1 <- rep("Cooperate", round(n2*coop2, 0))
a2 <- rep("Defect",  round(n2-(n2*coop2), 0))
cond <- rep("Alternating", n2)
alt_vec <- cbind(c(a1,a2), cond)
a1 <- rep("Cooperate", round(n3*props[i], 0))
a2 <- rep("Defect",  round(n3-(n3*props[i]), 0))
cond <- rep("Alone", n3)
alone_vec <- cbind(c(a1,a2), cond)
sim_data <- data.frame(rbind(sync_vec, alt_vec, alone_vec))
names(sim_data) <- c("Choice", "Condition")
contingency1 <- t(table(sim_data$Choice, sim_data$Condition))
prop.table(contingency1, margin = 1)
mosaicplot(contingency1)
chisq <- chisq.test(contingency1, simulate.p.value = TRUE)
z[i] <- chisq$p.value
}
plot(props, z, main = "Alone Condition Forecasting: 40 Participants/Group", xlab = "Proportion of Cooperating Participants", ylab = "p-value")
abline(h = .05, col = "red", lty = 2)
data <- read.csv("101_trial1.csv",stringsAsFactors = T)
### Social Drumming Analysis ###
library(tidyverse)
library(zoo)
library(ggplot2)
rm(list=ls())
# Importing
setwd("~/McMaster/Third Year/PNB 3QQ3/Drumming and Cooperation/Data")
data <- read.csv("101_trial1.csv",stringsAsFactors = T)
# Renaming variables to be readable
data <- data %>%
mutate(s_ppq = (s_ppq/(960*2)),e_ppq = (e_ppq/(960*2))) %>%
rename(start_s = s_ppq,end_s = e_ppq) %>%
select(-sel, -mut, -chan, -vel)
#adding a participant number to each drummer
data$participant <- ifelse(data$pitch==47,1,2)
data$participant <- as.factor(data$participant)
#onset difference between 2 participants and individual participants
data$onset_diff_2p <- data$start_s - lag(data$start_s, 1)
data <- data %>%
group_by(participant) %>%
mutate(onset_diff_1p = start_s - lag(start_s, 1))
data$hit_number <- 1:nrow(data)
# Basic line plot with points
data_fixed <- data
data$hit_number <- 1:nrow(data_fixed)
ggplot(data=data_fixed, aes(x=hit_number, y=onset_diff_1p_est, group=participant)) +
geom_line(aes(color=participant))+
geom_point(aes(color=participant))+
geom_smooth(data=data_fixed, aes(x=hit_number, y=roll_1p, color=participant),size=2)+
geom_vline(xintercept = 15,size=1)
ggplot(data=data_fixed, aes(x=hit_number, y=onset_diff_2p)) +
geom_line(aes(group=participant, color=participant))+
geom_point(aes(group=participant, color=participant))+
geom_smooth(data=data_fixed, aes(x=hit_number,y = roll_2p),size=2)+
geom_vline(xintercept = 15,size=1)
data <- data %>%
ungroup %>%
mutate(roll_2p = rollmean(onset_diff_2p, k=5, align = "right", fill = NA))
# Basic line plot with points
data_fixed <- data
ggplot(data=data_fixed, aes(x=hit_number, y=onset_diff_2p)) +
geom_line(aes(group=participant, color=participant))+
geom_point(aes(group=participant, color=participant))+
geom_smooth(data=data_fixed, aes(x=hit_number,y = roll_2p),size=2)+
geom_vline(xintercept = 15,size=1)
